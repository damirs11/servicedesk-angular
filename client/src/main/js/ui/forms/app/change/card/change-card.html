<div sd-loading="ctrl.loadingPromise" style="height: 100%">

    <content style="display: block; height: 100%">
        <!-- Card header -->
        <div class="entity-card-header">
            <div class="entity-container__content entity-container__header">
                <a data-ui-sref="app.change.list" style="margin-right: 10px">
                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                </a>
                <span>Изменение №{{ctrl.change.no}}:
                    <span style="font-weight: bold">{{ctrl.change.subject}}</span>
                </span>
            </div>
            <div class="entity-container__content entity-container__header">
                <sd-status-bar target="ctrl.change"
                               status-list="ctrl.statusList"
                ></sd-status-bar>
            </div>
            <div class="entity-container__content entity-container__header">
                <nav class="nav nav-pills nav-justified">
                    <li data-ui-sref-active="active">
                        <a data-ui-sref="app.change.card.view">Просмотр</a>
                    </li>
                    <li data-ui-sref-active="active" data-ng-if="!ctrl.change.entityAccessWWW.readHistoryAllowed">
                        <a data-ui-sref="app.change.card.history">История</a>
                    </li>
                    <li data-ui-sref-active="active" data-ng-if="!ctrl.change.entityAccessWWW.readApprovalAllowed">
                        <a data-ui-sref="app.change.card.approval">Согласование</a>
                    </li>
                    <li data-ui-sref-active="active" data-ng-if="!ctrl.change.entityAccessWWW.readAttachmentsAllowed">
                        <a data-ui-sref="app.change.card.attachments">Вложения</a>
                    </li>
                </nav>
            </div>
        </div>
        <!-- Body of view / history / approval / etc.-->
        <ui-view class="entity-card-body"></ui-view>
    </content>

    <error>
        <div class="container" style="padding-top: 200px; text-align: center">
            <div class="panel panel-danger" data-ng-if="ctrl.loadingErrorIsNotFound">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <span class="glyphicon glyphicon-ban-circle"></span>
                        Изменение не найдено
                    </h3>
                </div>
                <div class="panel-body">
                    Перейдите к
                    <a data-ui-sref="app.change.list">списку изменений</a>,
                    чтобы найти нужное изменение
                </div>
            </div>

            <div class="panel panel-danger" data-ng-if="ctrl.errorReadDisallowed">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <span class="glyphicon glyphicon-ban-circle"></span>
                        Ошибка доступа
                    </h3>
                </div>
                <div class="panel-body">
                    У вас нет прав на просмотр данного изменения
                </div>
            </div>

            <div class="panel panel-danger" data-ng-if="ctrl.loadingErrorIsCustom">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <span class="glyphicon glyphicon-ban-circle"></span>
                        Возникла непредвиденная ошибка
                    </h3>
                </div>
                <div class="panel-body">
                    <span data-ng-bind="ctrl.loadingError"></span>
                </div>
            </div>
        </div>
    </error>

</div>